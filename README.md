# Web-ларёк

Проект представляет собой интернет-магазин, предлагающий товары, предназначенные для веб-разработчиков. В магазине имеется католог товаров, которые можно добавить в корзину и с последующим оформлением заявки сделать заказ

## Описание

Проект иммеет архитектуру по принципу Model-View-Presenter (MVP), в котором каждый класс имеет свою роль и выполняет своб определенную задачу, тем самым обеспечивая четкое разделение ответственности между классами Model и View

- Model - работа с загрузкой данных по API, сохранение и работа с данными полученными от пользователя.

- View - отображает интерфейс для взаимодействия с пользователем, отлавливает и сообщает о произошедших событиях.

- Presenter - связывает модели данных с отображением интерфейсов при сработке какого нибудь события, управляя взаимодействием между ними непосредственно в основном скрипте приложения (index.ts).

### Стек технологий:

    HTML, SCSS, TS, Webpack

### Структура проекта:

- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

### Важные файлы:

- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Описание базовых классов

### Класс `Api` имеет следующие свойства и методы.

Поля:

- `baseUrl: string` - базовый URL для всех HTTP-запросов, выполняемых с использованием этого класса.
- `options: RequestInit` - настройки для запросов, включая заголовки, методы, тело запроса и другие параметры.

Методы:

- `handleResponse(response: Response): Promise<object>` - обработчик ответа сервера.
- `get(uri: string)` - принимает динамическую часть url-адреса и возвращает ответ от сервера.
- `post(uri: string, data: object, method: ApiPostMethods = 'POST')` - принимает динамическую часть url-адреса, принимает объект данных для отправки на сервер, type ApiPostMethods = 'POST' | 'PUT' | 'DELETE'.

### Класс `EventEmitter` - брокер событий, implements от IEvents и имеет следующие методы.

Класс EventEmitter реализует паттерн «Observer/Наблюдатель» и обеспечивает работу событий, его методы позволяют устанавливать и снимать слушатели событий, вызвать слушатели при возникновении события.

Поля:

- `events: Map<EventName, Set<Subscriber>>`

Методы:

- `on<T extends object>(eventName: EventName, callback: (event: T) => void)` - для подписки на событие.
- `off(eventName: EventName, callback: Subscriber)` - для отписки от события.
- `emit<T extends object>(eventName: string, data?: T)` - уведомления подписчиков о наступлении события соответственно.
- `onAll(callback: (event: EmitterEvent) => void)` - для подписки на все события.
- `offAll()` - сброса всех подписчиков.
- `trigger<T extends object>(eventName: string, context?: Partial<T>)` - генерирует заданное событие с заданными аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса `EventEmitter`.

## Описание классов Model, которые позволяют хранить и обрабатывать данные с сервера и от пользователей.

### Класс `ApiModel` наследуется от класса `Api` и относится к слою коммуникации приложения.

Его основная задача — обеспечивать взаимодействие с сервером, отправляя запросы и обрабатывая ответы.

Поля:

- `cdn: string` - URL для добавления изображения к карточкам товаров.
- `items: IProductItem[]` - массив объектов, представляющий данные о продуктах.

Методы:

- `getProductItems(): Promise<IProductItem[]>` - получаем массив карточек с сервера.
- `postOrder(order: IOrder): Promise<IOrderResult>` - отправляем запрос на сервер по сделанному/отправленному заказу.

### Класс `BasketModel` хранит и работает с данными полученными от пользователя.

Поля:

- `basketProducts: IProductItem[]` - список товаров, добавленных в корзину.

Методы:

- `getQuantity(): number` - получает количество товаров в корзине.
- `getProductsSum(): number` - считает и выводит сумму всех товаров в корзине.
- `addItemToBasket(data: IProductItem): void` - добавляет товар в корзину.
- `deleteItemFromBasket(item: IProductItem): void` - удаляет товар из корзины.
- `clearBasket(): void` - очищает корзину.

## Класс `DataModel` управляет данными о продуктах и хранит текущую выбранную карточку.

Поля:

- `productCards: IProductItem[]` - массив объектов продуктов, который хранит список всех продуктов.
- `selectedCard: IProductItem` - текущий выбранный продукт. Используется для отображения подробной информации о продукте.

Методы:

- `productCards(data: IProductItem[])` - устанавливает данные для продуктов.
- `get productCards()` - получает текущий список продуктов.
- `setPreview(item: IProductItem)` - устанавливает выбранную карточку продукта и генерирует событие открытия модального окна карточки.

### Класс `FormModel` хранит данные полученные от пользователя для оформления заказа.

Поля:

- `payment: string` - информация о методе оплаты.
- `email: string` - электронная почта пользователя.
- `phone: string` - номер телефона пользователя.
- `address: string` - адрес пользователя.
- `total: number` - общая сумму заказа.
- `items: string[]` - массив, в котором хранятся наименования товаров.
- `formErrors: FormErrors` - объект для хранения ошибок валидации, в котором ключи соответствуют полям формы, а значения содержат описание ошибок.

Методы:

- `setOrderAddress(value: string): void` - принимает адрес пользователя.
- `setOrderData(field: 'email' | 'phone', value: string): void` - принимает номер телефона и почту пользователя.
- `setOrderPayMethod(value: string): void` - принимает способ оплаты.
- `validateAdress()` - валидация адреса.
- `validateContacts()` - валидация номера телефона и почты пользователя.
- `getOrderData(): { email: string, phone: string, address: string, payment: string, total: number, items: string[] }` - получение всех данных заказа для формирования объекта с данными для отправки на сервер.

## Классы View позволяют отображать элементы страницы с полученными данными, позволяют взаимодействовать с пользователем.

### Класс `Basket` отвечает за отображение корзины.

Поля:

- `basket: HTMLElement` - основной DOM-элемент корзины, который будет отображен на странице.
- `title: HTMLElement` - DOM-элемент заголовка корзины.
- `basketList: HTMLElement` - DOM-элемент, который отображает список товаров корзины.
- `orderButton: HTMLElement` - кнопка для оформления заказа.
- `basketPrice: HTMLElement` - DOM-элемент, отображающий общую стоимость товаров в корзине.
- `button: HTMLElement` - кнопка на шапке сайта для открытия корзины
- `basketItemQuantity: HTMLElement` - элемент, отображающий количество товаров в корзине

Методы:

- `set items(items: HTMLElement[])` - устанавливает список товаров в корзине.
- `renderBasketQuantity(value: number): void` - отображает количество товаров в корзине (для обновления числа товаров в иконке корзины в шапке сайта).
- `renderTotal(sumAll: number): void` - отображает общую сумму товаров в корзине.
- `render()` - отображает корзину с установленным заголовком "Корзина" и возвращает элемент корзины для дальнейшего использования в DOM.

### Класс `BasketItem` отвечает за отображение отдельного товара в корзине.

Поля:

- `basketItem: HTMLElement` - DOM-элемент, представляющий один товар в корзине.
- `index: HTMLElement` - DOM-элемент отображающий индекс (номер) товара в списке корзины.
- `title: HTMLElement` - DOM-элемент, содержащий название товара.
- `price: HTMLElement` - DOM-элемент, отображающий цену товара.
- `buttonDelete: HTMLElement` - кнопка для удаления товара из корзины.

Методы:

- `setPrice(value: number | null)` - устанавливает цену товара.
- `render(data: IProductItem, item: number): void` - отображает товар в корзине. Устанавливает индекс товара (номер в корзине), его название и цену.

### Класс `Card` управляет отображением карточки товара на веб странице.

Поля:

- `cardElement: HTMLElement` - DOM-элемент, представляющий карточку товара.
- `categoryElement: HTMLElement` - DOM-элемент, отображающий категорию товара.
- `imageElement: HTMLElement` - элемент изображения товара.
- `titleElement: HTMLElement` - элемент с названием товара.
- `priceElement: HTMLElement` - элемент с ценой товара.
- `colors: Record<string, string>` - объект, который сопоставляет названия категорий с CSS-классами для стилизации карточки товара.

Методы:

- `setText(element: HTMLElement, value: unknown): string` - устанавливает текстовое содержимое для переданного элемента. Возвращает установленное значение в строковом виде.
- `set cardCategory(value: string)` - устанавливает категорию товара и соответствующий ей CSS-класс для стилизации.
- `setPrice(value: number | null): string` - устанавливает цену товара.
- `render(data: IProductItem): HTMLElement` - отображает карточку товара, устанавливая категорию, название, изображение и цену товара.

### Класс `CardPreview` наследуется от класса `Card` и управляет отображением подробного описания карточки товара в превью, позволяет добавить карточку в корзину.

Поля:

- `text: HTMLElement` - DOM-элемент, отображающий описание товара в карточке товара.
- `button: HTMLElement` - кнопка добавления товара в корзину.

Методы:

- `notSale(data: IProductItem): string` - проверяет, доступен ли товар для покупки.
- `render(data: IProductItem): HTMLElement` - отображает карточку товара, устанавливая категорию, название, изображение, цену, описание и текст на кнопке.

### Класс `Contacts` управляет отображением содержимого модального окна и позволяет принять от пользователя номер телефона и email-адрес.

Поля:

- `formContacts: HTMLFormElement` - DOM-элемент формы контактов.
- `inputAll: HTMLInputElement[]` - массив всех полей ввода формы.
- `buttonSubmit: HTMLButtonElement` - кнопка отправки формы.
- `formErrors: HTMLElement` - элемент, в котором будут отображаться ошибки формы.

Методы:

- `set valid(value: boolean)` - устанавливает, доступна ли кнопка отправки формы
- `render(): HTMLElement` - возвращает элемент формы, готовый для добавления в DOM.

### Класс `Order` управляет отображением содержимого модального окна и позволяет принять от пользователя метод оплаты и адрес.

Поля:

- `formOrder: HTMLFormElement` - элемент формы заказа.
- `buttonAll: HTMLButtonElement[]` - массив кнопок выбора метода оплаты.
- `buttonSubmit: HTMLButtonElement` - кнопка отправки формы заказа.
- `formErrors: HTMLElement` - элемент, в котором будут отображаться ошибки формы.

Методы:

- `paymentSelection(paymentMethod: string)` - устанавливает обводку вокруг выбранного метода оплаты.
- `set valid(value: boolean)` - устанавливает, доступна ли кнопка отправки формы заказа.
- `render(): HTMLElement` - возвращает элемент формы заказа, готовый для добавления в DOM.

### Класс `Modal` управляет модальными окнами на странице, позволяя открывать и закрывать их с заданным содержимым.

Поля:

- `modalContainer: HTMLElement` - DOM-элемент, представляющий модальное окно.
- `closeButton: HTMLButtonElement` - кнопка для закрытия модального окна.
- `content: HTMLElement` - контейнер, в который будет загружаться содержимое модального окна.
- `pageWrapper: HTMLElement` - элемент, который используется для блокировки прокрутки страницы при открытом модальном окне.

Методы:

- `content(value: HTMLElement)` - устанавливает содержимое модального окна.
- `open()` - открывает модальное окно.
- `close()` - закрывает модальное окно.
- `locked(value: boolean)` - устанавливает блокировку страницы при открытом модальном окне.
- `render(): HTMLElement` - отображает модальное окно.

### Класс `Success` отображает сообщение об успешном завершении заказа, в котором указывается количество списанных синапсов.

Поля:

- `success: HTMLElement` - DOM-элемент, представляющий контейнер успешного завершения заказа.
- `description: HTMLElement` - элемент, в котором будет отображаться описание успешного завершения заказа.
- `button: HTMLButtonElement` - кнопка для закрытия сообщения об успешном завершении заказа.

Методы:

- `render(total: number)` - заполняет описание успешного завершения заказа информацией о списанных синапсах.

## Установка и запуск

Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```

## Сборка

```
npm run build
```

или

```
yarn build
```
