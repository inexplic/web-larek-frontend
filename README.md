# Web-ларёк
Проект представляет собой интернет-магазин, предлагающий товары, предназначенные для веб-разработчиков. В магазине имеется католог товаров, которые можно добавить в корзину и с последующим оформлением заявки сделать заказ

## Описание

Проект иммеет архитектуру по принципу Model-View-Presenter (MVP), в котором каждый класс имеет свою роль и выполняет своб определенную задачу, тем самым обеспечивая четкое разделение ответственности между классами Model и View

- Model - работа с загрузкой данных по API, сохранение и работа с данными полученными от пользователя.

- View - отображает интерфейс для взаимодействия с пользователем, отлавливает и сообщает о произошедших событиях.

- Presenter - связывает модели данных с отображением интерфейсов при сработке какого нибудь события, управляя взаимодействием между ними непосредственно в основном скрипте приложения (index.ts).

### Стек технологий:
    HTML, SCSS, TS, Webpack

### Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

### Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Описание базовых классов

### Класс `Api` имеет следующие свойства и методы.

Поля:
- `baseUrl: string` - базовый URL для всех HTTP-запросов, выполняемых с использованием этого класса.
- `options: RequestInit` - настройки для запросов, включая заголовки, методы, тело запроса и другие параметры.

Методы:
- `handleResponse(response: Response): Promise<object>` - обработчик ответа сервера.
- `get(uri: string)` - принимает динамическую часть url-адреса и возвращает ответ от сервера.
- `post(uri: string, data: object, method: ApiPostMethods = 'POST')` - принимает динамическую часть url-адреса, принимает объект данных для отправки на сервер, type ApiPostMethods = 'POST' | 'PUT' | 'DELETE'.

### Класс `EventEmitter` - брокер событий, implements от IEvents и имеет следующие методы.

Класс EventEmitter реализует паттерн «Observer/Наблюдатель» и обеспечивает работу событий, его методы позволяют устанавливать и снимать слушатели событий, вызвать слушатели при возникновении события.

Поля:
- `events: Map<EventName, Set<Subscriber>>`

Методы:
- `on<T extends object>(eventName: EventName, callback: (event: T) => void)` - для подписки на событие.
- `off(eventName: EventName, callback: Subscriber)` - для отписки от события.
- `emit<T extends object>(eventName: string, data?: T)` - уведомления подписчиков о наступлении события соответственно.
- `onAll(callback: (event: EmitterEvent) => void)` - для подписки на все события.
- `offAll()` - сброса всех подписчиков.
- `trigger<T extends object>(eventName: string, context?: Partial<T>)` - генерирует заданное событие с заданными аргументами. Это позволяет передавать его в качестве обработчика события в другие классы. Эти классы будут генерировать события, не будучи при этом напрямую зависимыми от класса `EventEmitter`.

## Описание классов Model, которые позволяют хранить и обрабатывать данные с сервера и от пользователей.

### Класс `ApiModel` наследуется от класса `Api` и относится к слою коммуникации приложения. 

Его основная задача — обеспечивать взаимодействие с сервером, отправляя запросы и обрабатывая ответы.

Поля:
- `items: IProductItem[]` - массив объектов, представляющий данные о продуктах.

Методы:
- `getProductItems(): Promise<IProductItem[]>` - получаем массив карточек с сервера.
- `postOrder(order: IOrder): Promise<IOrderResult>` - отправляем запрос на сервер по сделанному/отправленному заказу.

### Класс `BasketModel` хранит и работает с данными полученными от пользователя.

Поля:
- `basketProducts: IProductItem[]` - список товаров, добавленных в корзину.

Методы:
- `getQuantity(): number` - получает количество товаров в корзине.
- `getProductsSum(): number` - считает и выводит сумму всех товаров в корзине.
- `addItemToBasket(data: IProductItem): void` - добавляет товар в корзину.
- `deleteItemFromBasket(item: IProductItem): void` - удаляет товар из корзины.
- `hasItemInBasket(productId: string): boolean` - проверяет, есть ли товар с указанным идентификатором в корзине.
- `getItems(): IProductItem[]` - возвращает список всех товаров, находящихся в корзине.

### Класс `FormModel` хранит данные полученные от пользователя для оформления заказа.

Поля:
- `payment: string` - информация о методе оплаты.
- `email: string` - электронная почта пользователя.
- `phone: string` - номер телефона пользователя.
- `address: string` - адрес пользователя.
- `total: number` - общая сумму заказа.
- `items: string[]` - массив, в котором хранятся наименования товаров.

Методы:
- `setOrderAddress(value: string): void` - принимает адрес пользователя.
- `setOrderData(field: 'email' | 'phone', value: string): void` - принимает номер телефона и почту пользователя.
- `setOrderPayMethod(value: string): void` - принимает способ оплаты.
- `isValidEmail(email: string): boolean` - валидация email.
- `isValidPhone(phone: string): boolean` - валидация телефона.
- `getOrderData(): { email: string, phone: string, address: string, payment: string, total: number, items: string[] }` - получение всех данных заказа для формирования объекта с данными для отправки на сервер.

## Классы View позволяют отображать элементы страницы с полученными данными, позволяют взаимодействовать с пользователем.

### Класс `Basket` отвечает за отображением корзины.

Поля:
- `basketList: HTMLElement` - DOM-элемент, который отображает список товаров корзины.
- `totalPrice: HTMLElement` - DOM-элемент, который отображает итоговую цену корзины.
- `orderButton: HTMLElement` - DOM-элемент кнопки для оформления заказа.

Методы:
- `render(products: IProductItem[]): void` - отображения списка товаров в корзине.
- `renderTotal(totalPrice: number): void` - отображает итоговую сумму покупок.
- `getOrderButton(): HTMLElement` - возвращает элемент кнопки для оформления заказа.
- `getRemoveButtons(): NodeListOf<HTMLElement>` - возвращает коллекцию кнопок для удаления товаров из корзины.

### Класс `Card` управляет отображением карточки товара на веб странице.

Поля:
- `cardElement: HTMLElement` - DOM-элемент, представляющий карточку товара.
- `imageElement: HTMLElement` - элемент изображения товара.
- `titleElement: HTMLElement` - элемент с названием товара.
- `priceElement: HTMLElement` - элемент с ценой товара.
- `descriptionElement: HTMLElement` - элемент с описанием товара.
- `addToBasketButton: HTMLElement` - кнопка для добавления товара в корзину.

Методы:
- `render(product: IProductItem): void` - отображает карточку товара на основе переданных данных.
- `setImage(image: string): void` - обновляет изображение товара на карточке.
- `setTitle(title: string): void` - обновляет название товара.
- `setPrice(price: number): void` - обновляет цену товара.
- `setDescription(description: string): void` - обновляет описание товара.
- `getAddToBasketButton(): HTMLElement` - возвращает кнопку для добавления товара в корзину.

### Класс `CardPreview` наследуется от класса `Card` и управляет отображением подробного описания карточки товара в превью, позволяет добавить карточку в корзину.

Методы:
- `render(product: IProductItem): void` - переопределение метода render для отображения подробного описания.

### Класс `Order` управляет отображением содержимого модального окна и позволяет принять от пользователя метод оплаты и адрес.

Поля:
- `paymentMethodSelect: HTMLElement` - элемент, позволяющий пользователю выбрать метод оплаты.
- `addressInput: HTMLElement` - поле ввода для адреса доставки.
- `submitButton: HTMLElement` - кнопка для подтверждения заказа.
- `orderData: IOrderData | null` - объект, содержащий данные о заказе.

Методы:
- `createForm(): void` - создаёт и возвращает форму для ввода данных заказа.
- `getOrderData(): IOrderData | null` - возвращает данные о заказе.
- `submitOrder(): void` - обрабатывает нажатие кнопки "Оплатить".

### Класс `Modal` управляет отображением модальных окон.

Поля:
- `modalElement: HTMLElement` - DOM-элемент, представляющий модальное окно.

Методы:
- `show(contentElement: HTMLElement): void` - отображает модальное окно с переданным содержимым.
- `hide(): void` - скрывает модальное окно.

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```